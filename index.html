// ... (previous resultsContentHTML building) ...

            // *** Add the "Next Step" text ***
            // Ensure this block is correctly appended
            resultsContentHTML += `
                <div class="next-step-section">
                    <h3>Next Step: Build Your Panic Buddy Toolkit!</h3>
                    <p>
                        Now that you know what helps you feel grounded, gather your
                        favorite tools and put them in a small pouch or bag. This kit can go with you
                        to school, work, or anywhere you may need support.
                    </p>
                </div>
            `;
        } // End of else (checkedBoxes.length > 0)

        // --- Step 3: Open a new window and write the full HTML page ---
        let newWindow = window.open('', '_blank');
        newWindow.document.open();
        const currentDate = new Date(2025, 2, 26).toLocaleDateString();
        const currentLocation = "Carver, Minnesota";

        // *** Check the newWindow.document.write() call carefully ***
        newWindow.document.write(`
            <!DOCTYPE html><html lang="en"><head><meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Your Sensory Profile Results</title><style>
            /* Styles... */
            body{font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; padding: 15px; line-height:1.6; color: #333;}
            /* ... other styles ... */
            .next-step-section{ margin-top: 30px; padding-top: 15px; border-top: 1px dotted #aaa; } /* Ensure style exists */
            </style></head><body>
            <h1>Your Sensory Profile Results</h1>

            ${resultsContentHTML} <!-- Inject the generated content -->

            <hr style="margin-top: 30px;">
            <p><small>Results generated on ${currentDate} from ${currentLocation}. Consult a professional for personalized advice.</small></p>
            <button onclick="window.close();" class="close-btn">Close Results & Return</button>
            </body></html>
        `);
        newWindow.document.close();
    });

    // ... (Clear button listener) ...
